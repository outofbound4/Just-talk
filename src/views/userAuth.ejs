<!DOCTYPE html>
<html>

<head>
    <title>Login</title>
</head>
<link rel="shortcut icon" href="">
<link href="/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/pageLoading.css" rel="stylesheet">
<style>
    @import url('https://fonts.googleapis.com/css?family=Mukta');

    body {
        font-family: 'Mukta', sans-serif;
        height: 100px;
        min-height: 550px;
        background-image: url();
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;
        position: relative;
        overflow-y: hidden;
    }

    a {
        text-decoration: none;
        color: #444444;
    }

    .login-reg-panel {
        position: relative;
        top: 50%;
        transform: translateY(-50%);
        text-align: center;
        width: 70%;
        right: 0;
        left: 0;
        margin: auto;
        height: 400px;
        background-color: rgba(236, 48, 20, 0.9);
    }

    .white-panel {
        background-color: rgba(255, 255, 255, 1);
        height: 500px;
        position: absolute;
        top: -50px;
        width: 50%;
        right: calc(50% - 50px);
        transition: .3s ease-in-out;
        z-index: 0;
        box-shadow: 0 0 15px 9px #00000096;
    }

    .login-reg-panel input[type="radio"] {
        position: relative;
        display: none;
    }

    .login-reg-panel {
        color: #B8B8B8;
    }

    .login-reg-panel #label-login,
    .login-reg-panel #label-register {
        border: 1px solid #9E9E9E;
        padding: 5px 5px;
        width: 150px;
        display: block;
        text-align: center;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        font-size: 18px;
    }

    .login-info-box {
        width: 30%;
        padding: 0 50px;
        top: 20%;
        left: 0;
        position: absolute;
        text-align: left;
    }

    .register-info-box {
        width: 30%;
        padding: 0 50px;
        top: 20%;
        right: 0;
        position: absolute;
        text-align: left;

    }

    .right-log {
        right: 50px !important;
    }

    .login-show,
    .register-show {
        z-index: 1;
        display: none;
        opacity: 0;
        transition: 0.3s ease-in-out;
        color: #242424;
        text-align: left;
        padding: 50px;
    }

    .show-log-panel {
        display: block;
        opacity: 0.9;
    }

    .login-show input[type="text"],
    .login-show input[type="password"] {
        width: 100%;
        display: block;
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #b5b5b5;
        outline: none;
    }

    .login-show input[type="button"] {
        max-width: 150px;
        width: 100%;
        background: #444444;
        color: #f9f9f9;
        border: none;
        padding: 10px;
        text-transform: uppercase;
        border-radius: 2px;
        float: right;
        cursor: pointer;
    }

    .login-show a {
        display: inline-block;
        padding: 10px 0;
    }

    .register-show input[type="text"],
    .register-show input[type="password"] {
        width: 100%;
        display: block;
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #b5b5b5;
        outline: none;
    }

    .register-show input[type="button"] {
        max-width: 150px;
        width: 100%;
        background: #444444;
        color: #f9f9f9;
        border: none;
        padding: 10px;
        text-transform: uppercase;
        border-radius: 2px;
        float: right;
        cursor: pointer;
    }

    .credit {
        position: absolute;
        bottom: 10px;
        left: 10px;
        color: #3B3B25;
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        text-transform: uppercase;
        font-size: 12px;
        font-weight: bold;
        letter-spacing: 1px;
        z-index: 99;
    }

    a {
        text-decoration: none;
        color: #2c7715;
    }
</style>

<body>
    <div class="login-reg-panel mt-5">
        <div class="login-info-box">
            <h2>Have an account?</h2>
            <p>Welcome to login with Chatting app.</p>
            <label id="label-register" for="log-reg-show">Login</label>
            <input type="radio" name="active-log-panel" id="log-reg-show" checked="checked">
        </div>

        <div class="register-info-box">
            <h2>Don't have an account?</h2>
            <p>Welcome to be a member of this chatting app.</p>
            <label id="label-login" for="log-login-show">Register</label>
            <input type="radio" name="active-log-panel" id="log-login-show">
        </div>

        <div class="white-panel">
            <div class="login-show">
                <h2>LOGIN</h2>
                <form action="" id="login">
                    <input type="text" name="email" id="emailLogin" placeholder="Email" required>
                    <p id='validEmailLogin' style="color: coral;"></p>
                    <input type="password" name="password" placeholder="Password" required>
                    <p id='LoginResponse' style="color: red;"></p>
                    <div class="loader" id="loginLoader" style="float: right; display: none;"></div>
                    <input type="button" id="btnLogin" value="Login">
                    <a href="/forgetPassword">Forgot password?</a>
                </form>
            </div>
            <div class="register-show">
                <h2>REGISTER</h2>
                <form id="register" action="">
                    <input type="text" name="name" placeholder="Name" required>
                    <input type="text" id="emailRegister" name="email" placeholder="Email" required>
                    <p id='validEmailRegister' style="color: coral;"></p>
                    <input type="password" name="password" placeholder="Password" required>
                    <input type="password" placeholder="Confirm Password" required>
                    <p id='RegisterResponse' style="color: red;"></p>
                    <div class="loader" id="registerLoading" style="float: right; display: none;"></div>
                    <input type="button" id="btnRegister" value="Register">
                    <p id="400"></p>
                </form>
            </div>
        </div>
    </div>
</body>
<script src="/assets/jquery/jquery-3.5.1.min.js"></script>
<script src="/assets/bootstrap/js/bootstrap.min.js"></script>
<script src="/ajax/ajax.js"></script>
<script>

    $('#btnLogin').on('click', function () {
        $('#btnLogin').hide();
        $('#loginLoader').show();
        let email = $("#emailLogin").val();
        if (isEmail(email) == true) {
            var ajax = new Ajax();
            var urlData = ajax.create_url_data("login");
            // it sends request to UserAuthController
            ajax.processPOST("/login", urlData, postFunctionLogin);
        }
        else {
            $("#validEmailLogin").text("Please Enter valid email.");
        }
    });

    function postFunctionLogin(res) {
        $('#btnLogin').show();
        $('#loginLoader').hide();
        
        if (res.status === 400) {
            $("#LoginResponse").text("All fields are mendatory.");
        }
        else if (res.status === 200) {
            window.open("/chatbox", "_self");
        }
        else if (res.status === 422) {
            $("#LoginResponse").text("Unauthorised user, password incorrect.");
        }
        else if (res.status === 421) {
            $("#LoginResponse").text("Email not registered.");
        }
        else {
            $("#LoginResponse").text("Something went wrong.");

        }
    }

    $('#btnRegister').on('click', function () {
        $('#btnRegister').hide();
        $('#registerLoading').show();
        let email = $("#emailRegister").val();
        if (isEmail(email) == true) {
            var ajax = new Ajax();
            var urlData = ajax.create_url_data("register");
            ajax.processPOST("/register", urlData, postFunctionRegister);
        } else {
            $("#validEmailRegister").text("Please Enter valid email.");
        }
    });

    function postFunctionRegister(res) {
        $('#registerLoading').hide();
        $('#btnRegister').show();
        
        if (res.status === 400) {
            $("#RegisterResponse").text("All fields are mendatory.");
        }
        else if (res.status === true) {
            $("#RegisterResponse").text("Verification link has been sent to your email. Thanks!!");
        }
        else if (res.status === false) {
            $("#RegisterResponse").text("Please Check your internet connectivity. Thanks!!");
        }
        else if (res.status === 'userExist') {
            $("#RegisterResponse").text("Email id already registered.");
        }
        
        else {
            $("#RegisterResponse").text("Something went wrong.");
        }
    }

    // it validates email
    function isEmail(email) {
        var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        return regex.test(email);
    }
</script>
<script>
    $(document).ready(function () {
        $('.login-info-box').fadeOut();
        $('.login-show').addClass('show-log-panel');
    });
    $('.login-reg-panel input[type="radio"]').on('change', function () {
        if ($('#log-login-show').is(':checked')) {
            $('.register-info-box').fadeOut();
            $('.login-info-box').fadeIn();

            $('.white-panel').addClass('right-log');
            $('.register-show').addClass('show-log-panel');
            $('.login-show').removeClass('show-log-panel');

        } else if ($('#log-reg-show').is(':checked')) {
            $('.register-info-box').fadeIn();
            $('.login-info-box').fadeOut();

            $('.white-panel').removeClass('right-log');

            $('.login-show').addClass('show-log-panel');
            $('.register-show').removeClass('show-log-panel');
        }
    });
</script>

</html>